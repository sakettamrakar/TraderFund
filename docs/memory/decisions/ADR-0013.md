# ADR-0013: Local-First Filesystem Storage

**Status**: Accepted
**Date**: 2026-01-01
**Context**: The system needs a persistence layer for time-series data, cognitive state, and configurations. We must choose between a database server (PostgreSQL/TimescaleDB) or a filesystem-based approach.

## Decision

The system uses a **Local-First Filesystem Storage** model.

- **Data**: Stored in flat files (Parquet for time-series, JSONL for logs/raw, JSON/Markdown for state).
- **No RDBMS**: No dependencies on external database processes (Postgres, MySQL, Mongo).
- **Indexing**: Directory structure (`data/market/freq/symbol.parquet`) acts as the primary index.

## Rationale

- **Simplicity**: "Boring is Beautiful". Eliminates the operational complexity of managing DB users, connections, migrations, and backups.
- **Portability**: The entire system state is a folder. easy to backup, sync, or move.
- **Auditability**: Files are human-inspectable (Parquet tools, Text editor).
- **Performance**: Direct file I/O for column-oriented Access (Parquet) is faster than SQL overhead for our specific read patterns (full history load or date-range slice).

## Alternatives

- **TimescaleDB**: Good for time-series but adds a heavy Docker dependency. Rejected for current phase.
- **SQLite**: Single file DB. Rejected for high-concurrency write limitations (though strictly single-writer helps). Parquet is better for analytics.
- **Cloud Storage (S3)**: Rejected to maintain "Local-First" sovereignty and zero latency.

## Consequences

- **Concurrency**: Writes must be carefully managed (Single Writer Principle) to avoid file corruption.
- **Querying**: No SQL. Complex queries require loading data into Pandas/Polars.
- **Integrity**: No Foreign Key constraints enforced by the storage engine; application logic must enforce integrity.

## Evidence

- `docs/memory/11_deployment/evolution.md`: ยง3.2 Environment Assumptions "No database server"
- `docs/memory/04_architecture/data_flow.md`
